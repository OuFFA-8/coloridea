<div class="p-8 min-h-screen bg-slate-50 dark:bg-[#0b0f1a] transition-colors duration-500">
  <!-- Header -->
  <div class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12">
    <div>
      <h1 class="text-3xl font-black text-slate-900 dark:text-white tracking-tight">
        Clients Directory
      </h1>
      <p class="text-sm text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mt-1">
        {{ clients.length }} Partners
      </p>
    </div>
    <button
      (click)="toggleModal()"
      class="px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] transition-all shadow-xl shadow-blue-500/20 active:scale-95 cursor-pointer border-none"
    >
      + Register New Client
    </button>
  </div>

  <!-- Loading Skeleton -->
  @if (isLoading) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      @for (item of [1, 2, 3, 4, 5, 6]; track item) {
        <div
          class="bg-white dark:bg-[#111827] rounded-[2.5rem] border border-slate-100 dark:border-gray-800 p-8 animate-pulse"
        >
          <div class="flex items-start justify-between mb-6">
            <div class="w-16 h-16 rounded-2xl bg-slate-200 dark:bg-gray-700"></div>
            <div class="w-20 h-6 rounded-xl bg-slate-100 dark:bg-gray-800"></div>
          </div>
          <div class="h-6 w-40 bg-slate-200 dark:bg-gray-700 rounded-full mb-2"></div>
          <div class="h-4 w-28 bg-slate-100 dark:bg-gray-800 rounded-full"></div>
        </div>
      }
    </div>
  }

  <!-- Empty State -->
  @if (!isLoading && clients.length === 0) {
    <div class="flex flex-col items-center justify-center py-32 text-center">
      <div class="text-5xl mb-4">üë•</div>
      <h3
        class="text-sm font-black uppercase tracking-widest text-slate-700 dark:text-gray-300 mb-2"
      >
        No Clients Yet
      </h3>
      <p class="text-[11px] font-bold text-slate-400 uppercase tracking-wider">
        Add your first client to get started
      </p>
    </div>
  }

  <!-- Cards Grid -->
  @if (!isLoading && clients.length > 0) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      @for (client of clients; track client._id) {
        <div
          (click)="openClient(client._id)"
          class="group relative bg-white dark:bg-[#111827] rounded-[2.5rem] border border-slate-100 dark:border-gray-800 p-8 transition-all duration-500 hover:shadow-2xl hover:-translate-y-2 cursor-pointer overflow-hidden"
        >
          <!-- Pattern bar on top -->
          @if (client.pattern) {
            <div
              class="absolute top-0 left-0 right-0 h-1.5 group-hover:h-3 transition-all duration-700 bg-cover bg-center opacity-60"
              [style.backgroundImage]="'url(' + getPhotoUrl(client.pattern) + ')'"
            ></div>
          } @else {
            <div
              class="absolute top-0 left-0 right-0 h-1.5 group-hover:h-3 transition-all duration-700 bg-blue-500 opacity-60"
            ></div>
          }

          <!-- Delete Button -->
          <button
            (click)="deleteClient($event, client._id, client.name)"
            class="absolute top-5 right-5 w-8 h-8 rounded-xl bg-slate-100 dark:bg-gray-800 text-slate-400 hover:bg-red-50 hover:text-red-500 dark:hover:bg-red-900/20 opacity-0 group-hover:opacity-100 transition-all duration-200 flex items-center justify-center text-xs border-none cursor-pointer z-10"
          >
            ‚úï
          </button>

          <div class="flex items-start justify-between mb-6">
            <!-- Logo -->
            <div
              class="w-16 h-16 rounded-2xl bg-slate-50 dark:bg-gray-800 border border-slate-100 dark:border-gray-700 shadow-sm overflow-hidden flex items-center justify-center"
            >
              <img
                [src]="getPhotoUrl(client.logo || client.photo)"
                [alt]="client.name"
                class="w-full h-full object-contain p-2"
                (error)="$any($event.target).style.display = 'none'"
              />
            </div>
            <!-- Projects Count -->
            <span
              class="px-4 py-1.5 rounded-xl text-[9px] font-black bg-slate-50 dark:bg-gray-800 text-slate-400 group-hover:text-blue-600 transition-colors uppercase tracking-widest"
            >
              {{ client.projectsCount || 0 }} Projects
            </span>
          </div>

          <!-- Name -->
          <h3 class="text-2xl font-black text-slate-900 dark:text-white tracking-tight">
            {{ client.name }}
          </h3>

          <!-- Bottom -->
          <div
            class="mt-8 pt-6 border-t border-slate-50 dark:border-gray-800 flex items-center justify-between"
          >
            <span
              class="text-[10px] font-bold text-slate-300 dark:text-gray-600 lowercase tracking-wider truncate max-w-[70%]"
            >
              {{ client.email }}
            </span>
            <div
              class="w-10 h-10 rounded-full bg-slate-50 dark:bg-gray-800 flex items-center justify-center text-slate-400 group-hover:bg-blue-600 group-hover:text-white transition-all"
            >
              ‚Üí
            </div>
          </div>
        </div>
      }
    </div>
  }

  <!-- Modal -->
  @if (showModal) {
    <div class="fixed inset-0 z-[100] flex items-center justify-center p-6">
      <div class="fixed inset-0 bg-slate-900/60 backdrop-blur-md" (click)="toggleModal()"></div>

      <div
        class="relative w-full max-w-2xl bg-white dark:bg-[#111827] rounded-[3rem] p-10 shadow-2xl border border-slate-200 dark:border-gray-800 max-h-[90vh] overflow-y-auto"
      >
        <h2 class="text-2xl font-black text-slate-900 dark:text-white mb-8 tracking-tight">
          Register New Client
        </h2>

        <form [formGroup]="clientForm" (ngSubmit)="saveClient()" class="space-y-6">
          <!-- Name -->
          <div class="space-y-2">
            <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1"
              >Full Name</label
            >
            <input
              formControlName="name"
              type="text"
              placeholder="Client name"
              class="w-full px-6 py-4 rounded-2xl bg-slate-50 dark:bg-gray-950 border border-slate-100 dark:border-gray-800 outline-none font-bold text-sm text-slate-900 dark:text-white"
            />
          </div>

          <div class="grid grid-cols-2 gap-6">
            <!-- Email -->
            <div class="space-y-2">
              <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1"
                >Email</label
              >
              <input
                formControlName="email"
                type="email"
                placeholder="name@company.com"
                class="w-full px-6 py-4 rounded-2xl bg-slate-50 dark:bg-gray-950 border border-slate-100 dark:border-gray-800 outline-none font-bold text-sm text-slate-900 dark:text-white"
              />
            </div>
            <!-- Password -->
            <div class="space-y-2">
              <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1"
                >Password</label
              >
              <input
                formControlName="password"
                type="password"
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                class="w-full px-6 py-4 rounded-2xl bg-slate-50 dark:bg-gray-950 border border-slate-100 dark:border-gray-800 outline-none font-bold text-sm text-slate-900 dark:text-white"
              />
            </div>
          </div>

          <!-- Files -->
          <div class="grid grid-cols-3 gap-4">
            <!-- Photo -->
            <div class="space-y-2">
              <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1"
                >Photo</label
              >
              <div
                class="relative h-28 rounded-2xl border-2 border-dashed border-slate-200 dark:border-gray-800 flex items-center justify-center overflow-hidden hover:border-blue-500 transition-colors bg-slate-50 dark:bg-gray-950 cursor-pointer"
              >
                @if (photoFile) {
                  <span class="text-[10px] font-black text-green-500 uppercase">‚úì Selected</span>
                } @else {
                  <div class="text-center opacity-40">
                    <span class="text-xl">üñºÔ∏è</span>
                    <p class="text-[8px] font-black uppercase mt-1">Photo</p>
                  </div>
                }
                <input
                  type="file"
                  (change)="onFileSelected($event, 'photo')"
                  class="absolute inset-0 opacity-0 cursor-pointer"
                  accept="image/*"
                />
              </div>
            </div>

            <!-- Logo -->
            <div class="space-y-2">
              <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1"
                >Logo</label
              >
              <div
                class="relative h-28 rounded-2xl border-2 border-dashed border-slate-200 dark:border-gray-800 flex items-center justify-center overflow-hidden hover:border-blue-500 transition-colors bg-slate-50 dark:bg-gray-950 cursor-pointer"
              >
                @if (logoPreview) {
                  <img [src]="logoPreview" class="h-full w-full object-contain p-3" />
                } @else {
                  <div class="text-center opacity-40">
                    <span class="text-xl">üè¢</span>
                    <p class="text-[8px] font-black uppercase mt-1">Logo</p>
                  </div>
                }
                <input
                  type="file"
                  (change)="onFileSelected($event, 'logo')"
                  class="absolute inset-0 opacity-0 cursor-pointer"
                  accept="image/*"
                />
              </div>
            </div>

            <!-- Pattern -->
            <div class="space-y-2">
              <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1"
                >Pattern</label
              >
              <div
                class="relative h-28 rounded-2xl border-2 border-dashed border-slate-200 dark:border-gray-800 flex items-center justify-center overflow-hidden hover:border-blue-500 transition-colors bg-slate-50 dark:bg-gray-950 cursor-pointer"
              >
                @if (patternPreview) {
                  <img [src]="patternPreview" class="h-full w-full object-cover" />
                } @else {
                  <div class="text-center opacity-40">
                    <span class="text-xl">üé®</span>
                    <p class="text-[8px] font-black uppercase mt-1">Pattern</p>
                  </div>
                }
                <input
                  type="file"
                  (change)="onFileSelected($event, 'pattern')"
                  class="absolute inset-0 opacity-0 cursor-pointer"
                  accept="image/*"
                />
              </div>
            </div>
          </div>

          <!-- Buttons -->
          <div class="flex gap-4 pt-4">
            <button
              type="button"
              (click)="toggleModal()"
              class="flex-1 py-4 rounded-2xl text-[10px] font-black uppercase text-slate-400 bg-slate-50 dark:bg-gray-800 cursor-pointer border-none"
            >
              Cancel
            </button>
            <button
              type="submit"
              [disabled]="clientForm.invalid || isSaving"
              class="flex-1 py-4 rounded-2xl text-[10px] font-black uppercase text-white bg-blue-600 hover:bg-blue-700 shadow-xl shadow-blue-500/20 cursor-pointer border-none disabled:opacity-50 transition-all"
            >
              {{ isSaving ? 'Saving...' : 'Register Client' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  }
</div>
